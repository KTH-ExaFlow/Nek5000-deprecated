!> @file ERR_EST
!! @brief Include file with parameter and common block definitions for 
!! error estimator
!! @author Adam Peplinski
!! @author Nicolas Offermans
!! @date Jun 20, 2016
!=======================================================================
!     maximum number of points in extrapolation
      integer EEST_NP_MAX
      parameter(EEST_NP_MAX = 4)

!     number of points in extrapolation
      integer EEST_NP
!     exclude EEST_ELR last rows from the extrapolation
      integer EEST_ELR

!     parameter for small values cutoff
!     used for values
      real EEST_SMALL
!     used for ratios
      real EEST_SMALLR
!     used for gradients
      real EEST_SMALLG
!     used for sigma and rtmp in error calculations
      real EEST_SMALLS

!     refinement and derefinement thresholds
      real EEST_REFT, EEST_DREFT

!     logical flags to mark variables for eest
      logical EEST_IFESTV(LDIMT3)

!     real vectors
!     spectral coefficient map; y and z are transposed
      real EEST_XMAP(LX1,LX1),EEST_YTMAP(LY1,LY1),EEST_ZTMAP(LZ1,LZ1),
     $     EEST_FAC(LX1,LY1,LZ1)

!     error estimate and decay rate
      real EEST_EST(LELT), EEST_SIG(LELT)
      
!     common blocks
      common /err_est_ipar/ EEST_NP, EEST_ELR

      common /err_est_lpar/ EEST_IFESTV

      common /err_est_rpar/ EEST_SMALL,EEST_SMALLR,EEST_SMALLG,
     $       EEST_SMALLS, EEST_REFT, EEST_DREFT

      common /err_est_map/ EEST_XMAP, EEST_YTMAP, EEST_ZTMAP,
     $            EEST_FAC

      common /nekp4est_eest_var/ EEST_EST, EEST_SIG